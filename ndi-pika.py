import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHJhbmRvbQppbXBvcnQgc29ja2V0CmltcG9ydCBzZWxlY3QKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCB0aHJlYWRpbmcKCmxvY2sgPSB0aHJlYWRpbmcuUkxvY2soKTsgb3Muc3lzdGVtKCdjbHMnIGlmIG9zLm5hbWUgPT0gJ250JyBlbHNlICdjbGVhcicpCgpkZWYgcmVhbF9wYXRoKGZpbGVfbmFtZSk6CiAgICByZXR1cm4gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpICsgZmlsZV9uYW1lCgpkZWYgZmlsdGVyX2FycmF5KGFycmF5KToKICAgIGZvciBpIGluIHJhbmdlKGxlbihhcnJheSkpOgogICAgICAgIGFycmF5W2ldID0gYXJyYXlbaV0uc3RyaXAoKQogICAgICAgIGlmIGFycmF5W2ldLnN0YXJ0c3dpdGgoJyMnKToKICAgICAgICAgICAgYXJyYXlbaV0gPSAnJwoKICAgIHJldHVybiBbeCBmb3IgeCBpbiBhcnJheSBpZiB4XQoKZGVmIGNvbG9ycyh2YWx1ZSk6CiAgICBwYXR0ZXJucyA9IHsKICAgICAgICAnUjEnIDogJ1wwMzNbMzE7MW0nLCAnUjInIDogJ1wwMzNbMzE7Mm0nLAogICAgICAgICdHMScgOiAnXDAzM1szMjsxbScsICdZMScgOiAnXDAzM1szMzsxbScsCiAgICAgICAgJ1AxJyA6ICdcMDMzWzM1OzFtJywgJ0NDJyA6ICdcMDMzWzBtJwogICAgfQoKICAgIGZvciBjb2RlIGluIHBhdHRlcm5zOgogICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgnW3t9XScuZm9ybWF0KGNvZGUpLCBwYXR0ZXJuc1tjb2RlXSkKCiAgICByZXR1cm4gdmFsdWUKCmRlZiBsb2codmFsdWUsIHN0YXR1cz0nJywgY29sb3I9JycpOgogICAgdmFsdWUgPSBjb2xvcnMoJ3tjb2xvcn1be3RpbWV9XSBbQ0NdPj57Y29sb3J9e3N0YXR1c30gW0NDXXtjb2xvcn17dmFsdWV9W0NDXScuZm9ybWF0KAogICAgICAgIHRpbWU9ZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoJyVIOiVNJyksCiAgICAgICAgdmFsdWU9dmFsdWUsCiAgICAgICAgY29sb3I9Y29sb3IsCiAgICAgICAgc3RhdHVzPXN0YXR1cwogICAgKSkKICAgIHdpdGggbG9jazogcHJpbnQodmFsdWUpCgpjbGFzcyBpbmplY3Qob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpbmplY3RfaG9zdCwgaW5qZWN0X3BvcnQpOgogICAgICAgIHN1cGVyKGluamVjdCwgc2VsZikuX19pbml0X18oKQoKICAgICAgICBzZWxmLmluamVjdF9ob3N0ID0gc3RyKGluamVjdF9ob3N0KQogICAgICAgIHNlbGYuaW5qZWN0X3BvcnQgPSBpbnQoaW5qZWN0X3BvcnQpCgogICAgZGVmIGxvZyhzZWxmLCB2YWx1ZSwgY29sb3I9J1tHMV0nKToKICAgICAgICBsb2codmFsdWUsIGNvbG9yPWNvbG9yKQoKICAgIGRlZiBzdGFydChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNvY2tldF9zZXJ2ZXIgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCiAgICAgICAgICAgIHNvY2tldF9zZXJ2ZXIuYmluZCgoc2VsZi5pbmplY3RfaG9zdCwgc2VsZi5pbmplY3RfcG9ydCkpCiAgICAgICAgICAgIHNvY2tldF9zZXJ2ZXIubGlzdGVuKDEpCiAgICAgICAgICAgIGZyb250ZW5kX2RvbWFpbnMgPSBvcGVuKHJlYWxfcGF0aCgnL2NvbmZpZy50eHQuZW5jJykpLnJlYWRsaW5lcygpCiAgICAgICAgICAgIGZyb250ZW5kX2RvbWFpbnMgPSBmaWx0ZXJfYXJyYXkoZnJvbnRlbmRfZG9tYWlucykKICAgICAgICAgICAgaWYgbGVuKGZyb250ZW5kX2RvbWFpbnMpID09IDA6CiAgICAgICAgICAgICAgICBzZWxmLmxvZygnRnJvbnRlbmQgRG9tYWlucyBub3QgZm91bmQuIFBsZWFzZSBjaGVjayBjb25maWcudHh0LmVuYycsIGNvbG9yPSdHMScpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5sb2coJ/CfmoArWyBTdGFydCBQc2lwaG9ubnlhIEJvc2t1IF0r8J+agCBcbltDQ11Mb2NhbCBIb3N0L1BvcnQgOiBbQ0NdMTI3LjAuMC4xLzgwODAnLmZvcm1hdChzZWxmLmluamVjdF9ob3N0LCBzZWxmLmluamVjdF9wb3J0KSkKICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgIHNvY2tldF9jbGllbnQsIF8gPSBzb2NrZXRfc2VydmVyLmFjY2VwdCgpCiAgICAgICAgICAgICAgICBzb2NrZXRfY2xpZW50LnJlY3YoNDA5NikKICAgICAgICAgICAgICAgIGRvbWFpbl9mcm9udGluZyhzb2NrZXRfY2xpZW50LCBmcm9udGVuZF9kb21haW5zKS5zdGFydCgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBleGNlcHRpb246CiAgICAgICAgICAgIHNlbGYubG9nKCfinYxTY3JpcHQgRXJyb3IhIS4gSGFwdXMgRGF0YSAmIE11bGFpIFVsYW5n4oC877iPJy5mb3JtYXQoc2VsZi5pbmplY3RfaG9zdCwgc2VsZi5pbmplY3RfcG9ydCksIGNvbG9yPSdbUjFdJykKCmNsYXNzIGRvbWFpbl9mcm9udGluZyh0aHJlYWRpbmcuVGhyZWFkKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzb2NrZXRfY2xpZW50LCBmcm9udGVuZF9kb21haW5zKToKICAgICAgICBzdXBlcihkb21haW5fZnJvbnRpbmcsIHNlbGYpLl9faW5pdF9fKCkKCiAgICAgICAgc2VsZi5mcm9udGVuZF9kb21haW5zID0gZnJvbnRlbmRfZG9tYWlucwogICAgICAgIHNlbGYuc29ja2V0X3R1bm5lbCA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkKICAgICAgICBzZWxmLnNvY2tldF9jbGllbnQgPSBzb2NrZXRfY2xpZW50CiAgICAgICAgc2VsZi5idWZmZXJfc2l6ZSA9IDEwMjQKICAgICAgICBzZWxmLmRhZW1vbiA9IFRydWUKCiAgICBkZWYgbG9nKHNlbGYsIHZhbHVlLCBzdGF0dXM9JyAnLCAKICAgIGNvbG9yPScnKToKICAgICAgICBsb2codmFsdWUsIHN0YXR1cz1zdGF0dXMsIGNvbG9yPWNvbG9yKQoKICAgIGRlZiBoYW5kbGVyKHNlbGYsIHNvY2tldF90dW5uZWwsIHNvY2tldF9jbGllbnQsIGJ1ZmZlcl9zaXplKToKICAgICAgICBzb2NrZXRzID0gW3NvY2tldF90dW5uZWwsIHNvY2tldF9jbGllbnRdCiAgICAgICAgdGltZW91dCA9IDAKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0aW1lb3V0ICs9IDEKICAgICAgICAgICAgc29ja2V0X2lvLCBfLCBlcnJvcnMgPSBzZWxlY3Quc2VsZWN0KHNvY2tldHMsIFtdLCBzb2NrZXRzLCAzKQogICAgICAgICAgICBpZiBlcnJvcnM6IGJyZWFrCiAgICAgICAgICAgIGlmIHNvY2tldF9pbzoKICAgICAgICAgICAgICAgIGZvciBzb2NrIGluIHNvY2tldF9pbzoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBzb2NrLnJlY3YoYnVmZmVyX3NpemUpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBkYXRhOiBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAjIFNFTlQgLT4gUkVDRUlWRUQKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBzb2NrIGlzIHNvY2tldF9jbGllbnQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRfdHVubmVsLnNlbmRhbGwoZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBzb2NrIGlzIHNvY2tldF90dW5uZWw6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRfY2xpZW50LnNlbmRhbGwoZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IDAKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IGJyZWFrCiAgICAgICAgICAgIGlmIHRpbWVvdXQgPT0gNjA6IGJyZWFrCgogICAgZGVmIHJ1bihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYucHJveHlfaG9zdF9wb3J0ID0gcmFuZG9tLmNob2ljZShzZWxmLmZyb250ZW5kX2RvbWFpbnMpLnNwbGl0KCc6JykKICAgICAgICAgICAgc2VsZi5wcm94eV9ob3N0ID0gc2VsZi5wcm94eV9ob3N0X3BvcnRbMF0KICAgICAgICAgICAgc2VsZi5wcm94eV9wb3J0ID0gc2VsZi5wcm94eV9ob3N0X3BvcnRbMV0gaWYgbGVuKHNlbGYucHJveHlfaG9zdF9wb3J0KSA+PSAyIGFuZCBzZWxmLnByb3h5X2hvc3RfcG9ydFsxXSBlbHNlICc0NDMnCiAgICAgICAgICAgIHNlbGYubG9nKCdbRzFdVHVuZ2d1IFNlYmVudGFyLi4uICEhIScsJ1tDQ10nJ1tZMV0gICA+Pj4+JywnW0NDXScuZm9ybWF0KHNlbGYucHJveHlfaG9zdCwgc2VsZi5wcm94eV9wb3J0KSkKICAgICAgICAgICAgc2VsZi5sb2coJ1tQMV0gICBPcmFuZyBTYWJhciBEaSBTYXlhbmcgSmFuZGEnLCdbQ0NdJy5mb3JtYXQoc2VsZi5wcm94eV9ob3N0LCBzZWxmLnByb3h5X3BvcnQpKQogICAgICAgICAgICBzZWxmLnNvY2tldF90dW5uZWwuY29ubmVjdCgoc3RyKHNlbGYucHJveHlfaG9zdCksIGludChzZWxmLnByb3h5X3BvcnQpKSkKICAgICAgICAgICAgc2VsZi5zb2NrZXRfY2xpZW50LnNlbmRhbGwoYidIVFRQLzEuMSAyMDAgT0tcclxuXHJcbicpCiAgICAgICAgICAgIHNlbGYuaGFuZGxlcihzZWxmLnNvY2tldF90dW5uZWwsIHNlbGYuc29ja2V0X2NsaWVudCwgc2VsZi5idWZmZXJfc2l6ZSkKICAgICAgICAgICAgc2VsZi5zb2NrZXRfY2xpZW50LmNsb3NlKCkKICAgICAgICAgICAgc2VsZi5zb2NrZXRfdHVubmVsLmNsb3NlKCkKICAgICAgICAgICAgc2VsZi5sb2coJ+KcsHxfX19fX1N1ZGFoIEtvbmVrIEJvc2t1X19fX1984pywJy5mb3JtYXQoc2VsZi5wcm94eV9ob3N0LCBzZWxmLnByb3h5X3BvcnQpLCBjb2xvcj0nW1IxXScpCiAgICAgICAgZXhjZXB0IE9TRXJyb3I6CiAgICAgICAgICAgIHNlbGYubG9nKCdDb25uZWN0aW9uIGVycm9yJywgY29sb3I9J1tSMV0nKQogICAgICAgIGV4Y2VwdCBUaW1lb3V0RXJyb3I6CiAgICAgICAgICAgIHNlbGYubG9nKCd7fSBub3QgcmVzcG9uZGluZycuZm9ybWF0KHNlbGYucHJveHlfaG9zdCksIGNvbG9yPSdbUjFdJykKCnByaW50KGNvbG9ycygnXG4nLmpvaW4oWwogICAgICAgICdbWTFd4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQJywgJ1tDQ10nCiAgICAgICAgJ1tSMV0gIOKWiOKWkeKWkeKWkeKWiCDilojiloDiloAg4paI4paR4paRIOKWiOKWkeKWkSDiloTiloAgIOKWhOKWgOKWhCDilojiloTilpHiloTilogg4paI4paA4paAJydbQ0NdJydbUjFd44WkJydbQ0NdJydbUjFd44WkJywgJ1tDQ10nCiAgICAgICAgJ1tSMV0gIOKWiOKWkeKWiOKWkeKWiCDilojiloDiloAg4paI4paR4paEIOKWiOKWkeKWhCDilojilpEgIOKWiOKWkeKWiCDilojilpHilojilpHilogg4paI4paA4paAJydbQ0NdJydbUjFd44WkJydbQ0NdJydbUjFd44WkJywgJ1tDQ10nCiAgICAgICAgJ1tZMV0gIOKWkeKWgOKWkeKWgOKWkSDiloDiloDiloAg4paA4paA4paAIOKWgOKWgOKWgCDilpHiloAgIOKWkeKWgOKWkSDiloDilpHilpHilpHiloAg4paA4paA4paAJydbQ0NdJydbUjFd44WkJydbQ0NdJydbUjFd44WkJywgJ1tDQ10nCiAgICAgICAgJ1tZMV3ilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAnLCAnW0NDXScKICAgICAgICAnW1IxXSAgICAgIFsnJ1tDQ10nJ1tZMV0rJydbQ0NdJydbUjFdXScnW0NDXScnW0cxXfCdl5rwnZel8J2XmPCdl6fwnZei8J2XofCdl5rwnZeY8J2XpfCdl6Yg8J2XnPCdl6HwnZeX8J2XovCdl6HwnZeY8J2XpvCdl5zwnZeUJydbQ0NdJydbUjFdWycnW0NDXScnW1kxXSsnJ1tDQ10nJ1tSMV1dJydbQ0NdJwogICAgICAgICdbUjFdICcsICdbQ0NdJwogICAgICAgICdbUjFdIOKVlFsnJ1tDQ10nJ1tZMV0rJydbQ0NdJydbUjFdXScnW0NDXScnW1kxXSBTY3JpcHQgVGVsa29tc2VsIEdhbWVzTWF4JywgJ1tDQ10nCiAgICAgICAgJ1tSMV0g4pWRJywgJ1tDQ10nICAgCiAgICAgICAgJ1tSMV0g4pWgWycnW0NDXScnW1kxXSonJ1tDQ10nJ1tSMV1dJydbQ0NdJydbUjFdIElNUE9STUFTSScsICdbQ0NdJwogICAgICAgICdbUjFdIOKVkXsnJ1tDQ10nJ1tZMV0xJydbQ0NdJydbUjFdfScnW0NDXScnW1kxXSBTdW5layBPbiBPZmYgRGF0YSBNb2RlIFBlc2F3YXQnLCAnW0NDXScKICAgICAgICAnW1IxXSDilZF7JydbQ0NdJydbWTFdMicnW0NDXScnW1IxXX0nJ1tDQ10nJ1tZMV0gSW5qZWN0IFFweXRob24gVGVybXV4JywgJ1tDQ10nCiAgICAgICAgJ1tSMV0g4pWgWycnW0NDXScnW1kxXSonJ1tDQ10nJ1tSMV1dJydbQ0NdJydbUjFdIFNldCBQc2lwaG9uJywgJ1tDQ10nCiAgICAgICAgJ1tSMV0g4pWReycnW0NDXScnW1kxXTMnJ1tDQ10nJ1tSMV19JydbQ0NdJydbWTFdIEhvc3QgMTI3LjAuMC4xJywgJ1tDQ10nCiAgICAgICAgJ1tSMV0g4pWReycnW0NDXScnW1kxXTQnJ1tDQ10nJ1tSMV19JydbQ0NdJydbWTFdIFBvcnQgODA4MCcsICdbQ0NdJwogICAgICAgICdbUjFdIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKJvScsICdbQ0NdJwogICAgICAgICdbUjFdICcsICdbQ0NdJwogICAgICAgICdbUjFdIOKVlFsnJ1tDQ10nJ1tHMV3imIYnJ1tDQ10nJ1tSMV1dJydbQ0NdJydbUDFdIFdoYXRzYXBwIDA4MjI1OTI4NTg4NicsICdbQ0NdJwogICAgICAgICdbUjFdIOKVmlsnJ1tDQ10nJ1tHMV3imIYnJ1tDQ10nJ1tSMV1dJydbQ0NdJydbUDFdIFNjcmlwdCBCeSBQaWthY2h1JywgJ1tDQ10nCiAgICAgICAgJ1tSMV0gJywgJ1tDQ10nCiAgICAgICAgJ1tSMV0gIFsnJ1tDQ10nJ1tHMV3il48nJ1tDQ10nJ1tSMV1dJydbQ0NdJydbUjFdIFZpcnVzIGFwYSB5YW5nIGxhZ2kgdmlyYWw/JywgJ1tDQ10nCiAgICAgICAgJ1tSMV0nLCAnW0NDXScsCiAgICBdKSkpCmRlZiBtYWluKCk6CiAgICBHID0gJyBFbnRlciB5b3VyIHBhc3N3b3JkICEnCiAgICBsaWtlID0gJ2Nvcm9uYScKICAgIHVzZXJfaW5wdXQgPSByYXdfaW5wdXQoJyAgSmF3YWJhbiA6ICcpCiAgICBpZiB1c2VyX2lucHV0ICE9IGxpa2U6CiAgICAgICAgc3lzLmV4aXQoJyAgV1JPTkcgSU5QVVQhIeKUjNCf4pSQKOKXo1/il6Ip4pSM0J/ilJBcbicpCiAgICBwcmludCAnIEluamVjdCBCZXJoYXNpbFxuJwogICAgaW5qZWN0KCcxMjcuMC4wLjEnLCAnODA4MCcpLnN0YXJ0KCkKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBtYWluKCkK'))